{
    "version": "2.0.0",
    "tasks": [
        // ============================================================
        // å¿«é€Ÿå»ºç½®èˆ‡éƒ¨ç½²ä»»å‹™ï¼ˆä¸»è¦ä½¿ç”¨ï¼‰
        // ============================================================
        {
            "label": "ğŸš€ Build & Deploy to SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-File",
                "${workspaceFolder}/.vscode/scripts/build-and-deploy.ps1"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "echo": true,
                "focus": true,
                "clear": true
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ”¨ Quick Build (No Tests)",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ“¦ å¿«é€Ÿå»ºç½®ï¼ˆè·³éæ¸¬è©¦ï¼‰...' -ForegroundColor Cyan; docker run --rm -v ${workspaceFolder}:/workspace -w /workspace maven:3.9-eclipse-temurin-11 mvn clean package -DskipTests -q"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ“¦ Deploy Plugin Only",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "$pluginJar = Get-ChildItem -Path '${workspaceFolder}/plugin-core/target' -Filter 'sonar-aiowasp-plugin-*.jar' | Select-Object -First 1; if ($pluginJar) { Write-Host 'ğŸ“¥ è¤‡è£½æ’ä»¶è‡³ SonarQube...' -ForegroundColor Green; Copy-Item -Path $pluginJar.FullName -Destination 'E:/sonarqube-community-25.10.0.114319/extensions/plugins/' -Force; Write-Host 'âœ… éƒ¨ç½²å®Œæˆï¼' -ForegroundColor Green; Write-Host 'âš ï¸  è«‹é‡å•Ÿ SonarQube ä»¥è¼‰å…¥æ’ä»¶' -ForegroundColor Yellow } else { Write-Host 'âŒ æ‰¾ä¸åˆ°æ’ä»¶ JAR æª”æ¡ˆ' -ForegroundColor Red }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        },
        // ============================================================
        // SonarQube ç®¡ç†ä»»å‹™
        // ============================================================
        {
            "label": "ğŸš€ Start SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸš€ å•Ÿå‹• SonarQube é–‹ç™¼ç’°å¢ƒ...' -ForegroundColor Cyan; docker-compose up -d; Start-Sleep -Seconds 5; Write-Host 'âœ… SonarQube æ­£åœ¨å•Ÿå‹•ï¼Œè«‹è¨ªå• http://localhost:9000' -ForegroundColor Green; Write-Host '   é è¨­å¸³è™Ÿï¼šadmin / admin' -ForegroundColor Yellow"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ›‘ Stop SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ›‘ åœæ­¢ SonarQube...' -ForegroundColor Yellow; docker-compose down; Write-Host 'âœ… SonarQube å·²åœæ­¢' -ForegroundColor Green"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ”„ Restart SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ”„ é‡å•Ÿ SonarQube...' -ForegroundColor Cyan; docker-compose restart sonarqube; Start-Sleep -Seconds 10; Write-Host 'âœ… SonarQube å·²é‡å•Ÿ' -ForegroundColor Green"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ“‹ View Logs",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "docker-compose logs -f sonarqube"
            ],
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "echo": true
            },
            "problemMatcher": []
        },
        // ============================================================
        // æ¸¬è©¦èˆ‡å“è³ªæª¢æŸ¥
        // ============================================================
        {
            "label": "ğŸ§ª Run Tests",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "docker run --rm -v ${workspaceFolder}:/workspace -w /workspace maven:3.9-eclipse-temurin-11 mvn test"
            ],
            "group": "test",
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ“Š Coverage Report",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "docker run --rm -v ${workspaceFolder}:/workspace -w /workspace maven:3.9-eclipse-temurin-11 mvn jacoco:report; Start-Process '${workspaceFolder}/target/site/jacoco/index.html'"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        },
        // ============================================================
        // å·¥å…·ä»»å‹™
        // ============================================================
        {
            "label": "ğŸ§¹ Clean All",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ§¹ æ¸…ç†æ‰€æœ‰å»ºæ§‹ç”¢ç‰©...' -ForegroundColor Yellow; docker run --rm -v ${workspaceFolder}:/workspace -w /workspace maven:3.9-eclipse-temurin-11 mvn clean; Write-Host 'âœ… æ¸…ç†å®Œæˆ' -ForegroundColor Green"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ—‘ï¸ Clean Old Plugins",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-File",
                "${workspaceFolder}/.vscode/scripts/clean-plugins.ps1"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ” Check Environment",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ” æª¢æŸ¥é–‹ç™¼ç’°å¢ƒ...' -ForegroundColor Cyan; Write-Host ''; Write-Host 'Docker ç‰ˆæœ¬ï¼š' -ForegroundColor Yellow; docker --version; Write-Host ''; Write-Host 'Docker Compose ç‰ˆæœ¬ï¼š' -ForegroundColor Yellow; docker-compose --version; Write-Host ''; Write-Host 'PowerShell ç‰ˆæœ¬ï¼š' -ForegroundColor Yellow; $PSVersionTable.PSVersion; Write-Host ''; Write-Host 'âœ… ç’°å¢ƒæª¢æŸ¥å®Œæˆ' -ForegroundColor Green"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true
            },
            "problemMatcher": []
        }
    ]
}
