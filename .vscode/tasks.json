{
    "version": "2.0.0",
    "tasks": [
        // ============================================================
        // ä¸»è¦å»ºç½®èˆ‡éƒ¨ç½²ä»»å‹™
        // ============================================================
        {
            "label": "ğŸš€ Build & Deploy to SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-File",
                "${workspaceFolder}/.vscode/scripts/build-and-deploy.ps1"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "echo": true,
                "focus": true,
                "clear": true
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ”¨ Quick Build (Skip Tests)",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ“¦ å¿«é€Ÿå»ºç½®ï¼ˆè·³éæ¸¬è©¦ï¼‰...' -ForegroundColor Cyan; mvn clean package -DskipTests -q; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… å»ºç½®æˆåŠŸ' -ForegroundColor Green } else { Write-Host 'âŒ å»ºç½®å¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ—ï¸ Full Build (With Tests)",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ“¦ å®Œæ•´å»ºç½®ï¼ˆå«æ¸¬è©¦ï¼‰...' -ForegroundColor Cyan; mvn clean package; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… å»ºç½®æˆåŠŸ' -ForegroundColor Green } else { Write-Host 'âŒ å»ºç½®å¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ“¦ Deploy Plugin Only",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "$pluginJar = Get-ChildItem -Path '${workspaceFolder}/plugin-core/target' -Filter 'sonar-aiowasp-plugin-*.jar' -ErrorAction SilentlyContinue | Select-Object -First 1; if ($pluginJar) { Write-Host 'ğŸ“¥ è¤‡è£½æ’ä»¶è‡³ SonarQube...' -ForegroundColor Green; $dest = 'E:/sonarqube-community-25.10.0.114319/extensions/plugins/'; if (-not (Test-Path $dest)) { New-Item -ItemType Directory -Path $dest -Force | Out-Null }; Copy-Item -Path $pluginJar.FullName -Destination $dest -Force; Write-Host 'âœ… éƒ¨ç½²å®Œæˆï¼' -ForegroundColor Green; Write-Host \"éƒ¨ç½²æª”æ¡ˆ: $($pluginJar.Name)\" -ForegroundColor Cyan; Write-Host 'âš ï¸  è«‹é‡å•Ÿ SonarQube ä»¥è¼‰å…¥æ’ä»¶' -ForegroundColor Yellow } else { Write-Host 'âŒ æ‰¾ä¸åˆ°æ’ä»¶ JAR æª”æ¡ˆï¼Œè«‹å…ˆåŸ·è¡Œå»ºç½®' -ForegroundColor Red; exit 1 }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        {
            "label": "âš¡ Incremental Build",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'âš¡ å¢é‡å»ºç½®ï¼ˆä¸æ¸…ç†ï¼‰...' -ForegroundColor Cyan; mvn package -DskipTests -q; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… å»ºç½®æˆåŠŸ' -ForegroundColor Green } else { Write-Host 'âŒ å»ºç½®å¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        // ============================================================
        // æ¸¬è©¦ç›¸é—œä»»å‹™
        // ============================================================
        {
            "label": "ğŸ§ª Run All Tests",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ§ª åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦...' -ForegroundColor Cyan; mvn test; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… æ¸¬è©¦é€šé' -ForegroundColor Green } else { Write-Host 'âŒ æ¸¬è©¦å¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "group": "test",
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "echo": true,
                "focus": true
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ¯ Run Specific Test",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "$testClass = Read-Host 'è«‹è¼¸å…¥æ¸¬è©¦é¡åˆ¥åç¨±ï¼ˆä¾‹å¦‚ï¼šRuleEngineTestï¼‰'; if ($testClass) { Write-Host \"ğŸ§ª åŸ·è¡Œæ¸¬è©¦: $testClass\" -ForegroundColor Cyan; mvn test -Dtest=$testClass; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… æ¸¬è©¦é€šé' -ForegroundColor Green } else { Write-Host 'âŒ æ¸¬è©¦å¤±æ•—' -ForegroundColor Red } } else { Write-Host 'âŒ æœªæŒ‡å®šæ¸¬è©¦é¡åˆ¥' -ForegroundColor Red }"
            ],
            "group": "test",
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": true
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ“Š Coverage Report",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ“Š ç”¢ç”Ÿæ¸¬è©¦æ¶µè“‹ç‡å ±å‘Š...' -ForegroundColor Cyan; mvn jacoco:report; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… å ±å‘Šç”¢ç”Ÿå®Œæˆ' -ForegroundColor Green; $reportPath = '${workspaceFolder}/plugin-core/target/site/jacoco/index.html'; if (Test-Path $reportPath) { Write-Host 'ğŸ“‚ é–‹å•Ÿå ±å‘Š...' -ForegroundColor Cyan; Start-Process $reportPath } else { Write-Host 'âš ï¸  å ±å‘Šæª”æ¡ˆä¸å­˜åœ¨ï¼Œè«‹å…ˆåŸ·è¡Œæ¸¬è©¦' -ForegroundColor Yellow } } else { Write-Host 'âŒ å ±å‘Šç”¢ç”Ÿå¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        // ============================================================
        // SonarQube æœå‹™ç®¡ç†
        // ============================================================
        {
            "label": "ğŸš€ Start SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸš€ å•Ÿå‹• SonarQube é–‹ç™¼ç’°å¢ƒ...' -ForegroundColor Cyan; if (Test-Path '${workspaceFolder}/docker-compose.yml') { docker-compose up -d; Start-Sleep -Seconds 5; Write-Host 'âœ… SonarQube æ­£åœ¨å•Ÿå‹•' -ForegroundColor Green; Write-Host '   è¨ªå•åœ°å€: http://localhost:9000' -ForegroundColor Cyan; Write-Host '   é è¨­å¸³è™Ÿ: admin / admin' -ForegroundColor Yellow; Write-Host '   å•Ÿå‹•æ™‚é–“: ç´„ 30-60 ç§’' -ForegroundColor Gray } else { Write-Host 'âŒ æ‰¾ä¸åˆ° docker-compose.yml' -ForegroundColor Red }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ›‘ Stop SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ›‘ åœæ­¢ SonarQube...' -ForegroundColor Yellow; if (Test-Path '${workspaceFolder}/docker-compose.yml') { docker-compose down; Write-Host 'âœ… SonarQube å·²åœæ­¢' -ForegroundColor Green } else { Write-Host 'âŒ æ‰¾ä¸åˆ° docker-compose.yml' -ForegroundColor Red }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ”„ Restart SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ”„ é‡å•Ÿ SonarQube...' -ForegroundColor Cyan; if (Test-Path '${workspaceFolder}/docker-compose.yml') { docker-compose restart sonarqube; Write-Host 'â³ ç­‰å¾… SonarQube å•Ÿå‹•...' -ForegroundColor Yellow; Start-Sleep -Seconds 10; Write-Host 'âœ… SonarQube å·²é‡å•Ÿ' -ForegroundColor Green; Write-Host '   è¨ªå•åœ°å€: http://localhost:9000' -ForegroundColor Cyan } else { Write-Host 'âŒ æ‰¾ä¸åˆ° docker-compose.yml' -ForegroundColor Red }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ“‹ View SonarQube Logs",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ“‹ é¡¯ç¤º SonarQube æ—¥èªŒ...' -ForegroundColor Cyan; Write-Host 'æŒ‰ Ctrl+C åœæ­¢æ—¥èªŒé¡¯ç¤º' -ForegroundColor Yellow; docker-compose logs -f sonarqube"
            ],
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "echo": true,
                "focus": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸŒ Open SonarQube",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸŒ é–‹å•Ÿ SonarQube ç¶²é ä»‹é¢...' -ForegroundColor Cyan; Start-Process 'http://localhost:9000'"
            ],
            "presentation": {
                "reveal": "silent",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        // ============================================================
        // æ¸…ç†èˆ‡ç¶­è­·
        // ============================================================
        {
            "label": "ğŸ§¹ Clean All",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ§¹ æ¸…ç†æ‰€æœ‰å»ºæ§‹ç”¢ç‰©...' -ForegroundColor Yellow; mvn clean; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… æ¸…ç†å®Œæˆ' -ForegroundColor Green } else { Write-Host 'âŒ æ¸…ç†å¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ—‘ï¸ Clean Old Plugins",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-File",
                "${workspaceFolder}/.vscode/scripts/clean-plugins.ps1"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ”„ Update Dependencies",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ”„ æ›´æ–° Maven ä¾è³´...' -ForegroundColor Cyan; mvn versions:display-dependency-updates; Write-Host ''; Write-Host 'ğŸ’¡ æç¤ºï¼šåŸ·è¡Œä»¥ä¸‹å‘½ä»¤æ›´æ–°ä¾è³´' -ForegroundColor Yellow; Write-Host '   mvn versions:use-latest-releases' -ForegroundColor Cyan"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": []
        },
        // ============================================================
        // é–‹ç™¼å·¥å…·
        // ============================================================
        {
            "label": "ğŸ” Check Environment",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host ''; Write-Host '============================================================' -ForegroundColor Cyan; Write-Host '  é–‹ç™¼ç’°å¢ƒæª¢æŸ¥' -ForegroundColor Cyan; Write-Host '============================================================' -ForegroundColor Cyan; Write-Host ''; Write-Host 'ğŸ“¦ Maven ç‰ˆæœ¬ï¼š' -ForegroundColor Yellow; mvn --version; Write-Host ''; Write-Host 'â˜• Java ç‰ˆæœ¬ï¼š' -ForegroundColor Yellow; java -version; Write-Host ''; Write-Host 'ğŸ’» PowerShell ç‰ˆæœ¬ï¼š' -ForegroundColor Yellow; $PSVersionTable.PSVersion; Write-Host ''; Write-Host 'ğŸ³ Docker ç‰ˆæœ¬ï¼ˆSonarQube ç”¨ï¼‰ï¼š' -ForegroundColor Yellow; docker --version; Write-Host ''; Write-Host 'ğŸ”§ Docker Compose ç‰ˆæœ¬ï¼ˆSonarQube ç”¨ï¼‰ï¼š' -ForegroundColor Yellow; docker-compose --version; Write-Host ''; Write-Host 'ğŸ“‚ å°ˆæ¡ˆè·¯å¾‘ï¼š' -ForegroundColor Yellow; Write-Host '   ${workspaceFolder}' -ForegroundColor Gray; Write-Host ''; Write-Host 'ğŸ”Œ SonarQube æ’ä»¶ç›®éŒ„ï¼š' -ForegroundColor Yellow; $pluginDir = 'E:/sonarqube-community-25.10.0.114319/extensions/plugins'; if (Test-Path $pluginDir) { Write-Host \"   $pluginDir\" -ForegroundColor Green; $plugins = Get-ChildItem -Path $pluginDir -Filter 'sonar-aiowasp-plugin-*.jar'; if ($plugins) { Write-Host \"   å·²å®‰è£æ’ä»¶: $($plugins.Name)\" -ForegroundColor Cyan } else { Write-Host '   å°šæœªéƒ¨ç½²æ’ä»¶' -ForegroundColor Yellow } } else { Write-Host \"   ç›®éŒ„ä¸å­˜åœ¨: $pluginDir\" -ForegroundColor Red }; Write-Host ''; Write-Host '============================================================' -ForegroundColor Green; Write-Host '  âœ… ç’°å¢ƒæª¢æŸ¥å®Œæˆ' -ForegroundColor Green; Write-Host '============================================================' -ForegroundColor Green; Write-Host ''"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "echo": true,
                "focus": true,
                "clear": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ“Š Project Info",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host ''; Write-Host '============================================================' -ForegroundColor Cyan; Write-Host '  å°ˆæ¡ˆè³‡è¨Š' -ForegroundColor Cyan; Write-Host '============================================================' -ForegroundColor Cyan; Write-Host ''; mvn help:effective-pom -Doutput=pom-effective.xml -q; $pom = [xml](Get-Content pom.xml); Write-Host 'ğŸ“¦ å°ˆæ¡ˆåç¨±: ' -NoNewline -ForegroundColor Yellow; Write-Host $pom.project.name -ForegroundColor White; Write-Host 'ğŸ”– ç‰ˆæœ¬è™Ÿ: ' -NoNewline -ForegroundColor Yellow; Write-Host $pom.project.version -ForegroundColor White; Write-Host 'ğŸ¢ çµ„ç¹”: ' -NoNewline -ForegroundColor Yellow; Write-Host $pom.project.groupId -ForegroundColor White; Write-Host 'ğŸ“ æè¿°: ' -NoNewline -ForegroundColor Yellow; Write-Host $pom.project.description -ForegroundColor White; Write-Host ''; Write-Host 'ğŸ“š æ¨¡çµ„åˆ—è¡¨:' -ForegroundColor Yellow; Get-ChildItem -Directory | Where-Object { Test-Path (Join-Path $_.FullName 'pom.xml') } | ForEach-Object { Write-Host \"   - $($_.Name)\" -ForegroundColor Cyan }; Write-Host ''; Write-Host '============================================================' -ForegroundColor Green; Write-Host ''"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "dedicated",
                "echo": true,
                "focus": true
            },
            "problemMatcher": []
        },
        {
            "label": "ğŸ”§ Validate POM",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ”§ é©—è­‰ POM æª”æ¡ˆ...' -ForegroundColor Cyan; mvn validate; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… POM é©—è­‰é€šé' -ForegroundColor Green } else { Write-Host 'âŒ POM é©—è­‰å¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": [
                "$maven"
            ]
        },
        {
            "label": "ğŸ“¦ Install to Local Repository",
            "type": "shell",
            "command": "pwsh",
            "args": [
                "-Command",
                "Write-Host 'ğŸ“¦ å®‰è£è‡³æœ¬æ©Ÿ Maven å€‰åº«...' -ForegroundColor Cyan; mvn clean install -DskipTests; if ($LASTEXITCODE -eq 0) { Write-Host 'âœ… å®‰è£å®Œæˆ' -ForegroundColor Green; Write-Host '   æœ¬æ©Ÿå€‰åº«: %USERPROFILE%\\.m2\\repository' -ForegroundColor Cyan } else { Write-Host 'âŒ å®‰è£å¤±æ•—' -ForegroundColor Red; exit $LASTEXITCODE }"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "echo": true,
                "focus": false
            },
            "problemMatcher": [
                "$maven"
            ]
        }
    ]
}
