# SonarQube AI OWASP Security Plugin - UX Specification

## 文件資訊

| 項目 | 內容 |
|------|------|
| **文件版本** | 1.0 |
| **文件狀態** | Draft |
| **建立日期** | 2025-10-19 |
| **基於文件** | PRD v1.0, Architecture v1.0 |
| **目標讀者** | 前端開發團隊、UI/UX 設計師、產品經理 |

---

## 目錄

1. [UX 設計原則](#ux-設計原則)
2. [設計系統與視覺風格](#設計系統與視覺風格)
3. [資訊架構](#資訊架構)
4. [核心畫面規格](#核心畫面規格)
5. [互動流程圖](#互動流程圖)
6. [多版本對照報告設計](#多版本對照報告設計)
7. [漏洞詳情頁面設計](#漏洞詳情頁面設計)
8. [配置頁面 UX 設計](#配置頁面-ux-設計)
9. [無障礙性實現](#無障礙性實現)
10. [響應式設計策略](#響應式設計策略)
11. [UI 組件庫](#ui-組件庫)
12. [互動狀態與回饋](#互動狀態與回饋)
13. [錯誤處理與空狀態](#錯誤處理與空狀態)

---

## UX 設計原則

### 核心設計哲學

**「安全性 + 可操作性 + 效率」**

本插件的 UX 設計遵循以下核心原則：

#### 1. 無縫整合 (Seamless Integration)
- **與 SonarQube 原生介面完全融合**，用戶無需學習新的操作模式
- 使用 SonarQube 既有的導航結構、配色方案、交互模式
- 插件介面應「看起來就像 SonarQube 內建功能」

#### 2. 資訊層次清晰 (Clear Information Hierarchy)
- 遵循「總覽 → 詳細」的漸進式資訊揭露
- 使用視覺層級引導用戶注意力（大小、顏色、位置）
- 關鍵資訊（嚴重性、漏洞數量）在第一眼就能看到

#### 3. 行動導向 (Action-Oriented)
- 每個漏洞都有明確的「下一步行動」
- 修復建議要「可操作」，而非僅描述問題
- 提供「一鍵複製代碼」、「匯出報告」等快速操作

#### 4. 效能感知 (Performance Awareness)
- 透過進度指示讓用戶了解 AI 分析狀態
- 使用骨架屏（Skeleton Screen）取代傳統 Loading 動畫
- 關鍵操作在 100ms 內提供視覺回饋

#### 5. 多版本可視化 (Multi-Version Visualization)
- 清晰展示不同 OWASP 版本的差異
- 使用顏色編碼區分版本（2017: 藍色、2021: 綠色、2025: 橙色）
- 提供版本映射表，幫助用戶理解類別演變

#### 6. 降低認知負荷 (Reduce Cognitive Load)
- 使用圖示和視覺符號取代純文字
- 分步驟展示複雜資訊（摺疊面板、標籤頁）
- 提供「快速過濾」和「智能搜尋」減少資訊過載

---

## 設計系統與視覺風格

### 配色方案 (Color Palette)

遵循 SonarQube 原生配色，並擴展安全相關顏色：

#### 主色調
```
Primary Blue:   #4B9FD5  (SonarQube 品牌色)
Dark Blue:      #236A97  (深色變化)
Light Blue:     #EAF4FB  (淺色背景)
```

#### 嚴重性配色 (Severity Colors)
```
Critical:       #DC3545  (紅色 - 危急)
High:           #FD7E14  (橙色 - 高風險)
Medium:         #FFC107  (黃色 - 中風險)
Low:            #6C757D  (灰色 - 低風險)
Info:           #17A2B8  (青色 - 資訊)
```

#### OWASP 版本配色 (Version Colors)
```
OWASP 2017:     #007BFF  (藍色)
OWASP 2021:     #28A745  (綠色 - 預設)
OWASP 2025:     #FF6B35  (橙色 + "Preview" 標籤)
```

#### 中性色 (Neutral Colors)
```
Black:          #000000
Dark Gray:      #343A40
Medium Gray:    #6C757D
Light Gray:     #DEE2E6
White:          #FFFFFF
Background:     #F3F3F3  (頁面背景)
Card BG:        #FFFFFF  (卡片背景)
Border:         #E0E0E0  (邊框)
```

### 字體系統 (Typography)

#### 字型家族
```
Primary Font:   'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif
Code Font:      'Roboto Mono', 'Courier New', monospace
```

#### 字型大小與階層
```
H1 (頁面標題):       32px / 2rem    (Bold, #000000)
H2 (區塊標題):       24px / 1.5rem  (Semibold, #343A40)
H3 (子標題):         20px / 1.25rem (Semibold, #343A40)
H4 (卡片標題):       18px / 1.125rem (Medium, #343A40)
Body (內文):         14px / 0.875rem (Regular, #6C757D)
Small (輔助文字):    12px / 0.75rem  (Regular, #6C757D)
Code (代碼):         13px / 0.8125rem (Regular, #E83E8C)
```

#### 行高與間距
```
標題行高:   1.2
內文行高:   1.6
段落間距:   16px (1rem)
區塊間距:   24px (1.5rem)
```

### 圖示系統 (Iconography)

使用 **Font Awesome 6** 作為圖示庫。

#### 關鍵圖示
```
漏洞 (Vulnerability):        fa-exclamation-triangle
AI 建議 (AI Suggestion):     fa-sparkles
修復 (Fix):                  fa-wrench
代碼 (Code):                 fa-code
報告 (Report):               fa-file-chart-line
下載 (Download):             fa-download
過濾 (Filter):               fa-filter
搜尋 (Search):               fa-magnifying-glass
設定 (Settings):             fa-gear
警告 (Warning):              fa-triangle-exclamation
成功 (Success):              fa-circle-check
錯誤 (Error):                fa-circle-xmark
載入中 (Loading):            fa-spinner-third (旋轉動畫)
```

### 陰影與圓角 (Shadows & Borders)

```css
/* 卡片陰影 */
.card-shadow {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.card-shadow-hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

/* 圓角 */
.border-radius-sm:  4px   (按鈕、標籤)
.border-radius-md:  8px   (卡片、輸入框)
.border-radius-lg:  12px  (大型容器)
```

---

## 資訊架構

### 導航結構

```
SonarQube 主導航
├── 專案總覽 (Projects)
├── 問題 (Issues)
├── 規則 (Rules)
├── 品質檔案 (Quality Profiles)
├── 品質閘道 (Quality Gates)
└── 更多 (More)
    └── ✨ OWASP 安全報告 ← 插件入口
        ├── 📊 報告總覽 (Dashboard)
        ├── 📄 單版本報告
        │   ├── OWASP 2017
        │   ├── OWASP 2021
        │   └── OWASP 2025 (Preview)
        ├── 🔄 多版本對照
        │   ├── 2017 vs 2021
        │   ├── 2021 vs 2025
        │   └── 2017 vs 2021 vs 2025
        ├── 📋 漏洞詳情列表
        ├── 📈 趨勢分析 (Phase 2)
        └── ⚙️ 插件配置
```

### 頁面層級

```
Level 1: 報告總覽頁面
    ↓ (點擊類別或版本)
Level 2: 單版本/多版本報告頁面
    ↓ (點擊漏洞項目)
Level 3: 漏洞詳情頁面
    ↓ (查看修復建議)
Level 4: 修復建議展開面板
```

### 麵包屑導航

```
專案 > OWASP 安全報告 > OWASP 2021 > A03:2021-Injection > SQL Injection in UserController.java
```

---

## 核心畫面規格

### 畫面 1: 插件配置頁面

**路徑**: `/admin/settings?category=ai-owasp`
**權限**: 管理員 (Administer)
**用途**: 配置 AI 模型、OWASP 版本、掃描參數

#### 線框圖描述

```
┌────────────────────────────────────────────────────────────────┐
│ ⚙️  OWASP AI Security Plugin - 配置                            │
├────────────────────────────────────────────────────────────────┤
│                                                                 │
│  【1. AI 模型配置】                                             │
│  ┌──────────────────────────────────────────────────────────┐ │
│  │ AI 供應商 *                                               │ │
│  │ ○ OpenAI GPT-4   ⦿ Anthropic Claude   ○ 本地模型 (Beta)│ │
│  │                                                           │ │
│  │ API 金鑰 *                                                │ │
│  │ [sk-...********************************] 🔒 加密存儲      │ │
│  │                                                           │ │
│  │ API 端點 (選填)                                           │ │
│  │ [https://api.openai.com/v1]                              │ │
│  │                                                           │ │
│  │ ▼ 進階參數                                                │ │
│  │   Temperature: [0.3────●──────1.0]  (創造性 vs 精確性)   │ │
│  │   最大 Token:  [2000]                                     │ │
│  │   超時時間:    [60] 秒                                    │ │
│  └──────────────────────────────────────────────────────────┘ │
│                                                                 │
│  【2. OWASP 版本配置】                                          │
│  ┌──────────────────────────────────────────────────────────┐ │
│  │ 啟用的版本 *                                              │ │
│  │ ☑ OWASP Top 10 2017  (10 個類別)                         │ │
│  │ ☑ OWASP Top 10 2021  (10 個類別，預設)                   │ │
│  │ ☑ OWASP Top 10 2025  (預覽版，規則可能變更)   ⚠️         │ │
│  │                                                           │ │
│  │ 預設版本:  [ OWASP 2021 ▼ ]                              │ │
│  └──────────────────────────────────────────────────────────┘ │
│                                                                 │
│  【3. 掃描配置】                                                │
│  ┌──────────────────────────────────────────────────────────┐ │
│  │ 掃描模式                                                  │ │
│  │ ⦿ 全專案掃描   ○ 增量掃描 (僅 Git diff)   ○ 手動選擇    │ │
│  │                                                           │ │
│  │ 包含路徑 (選填)                                           │ │
│  │ [src/**/*.java, src/**/*.js]                             │ │
│  │                                                           │ │
│  │ 排除路徑 (選填)                                           │ │
│  │ [**/*.test.js, **/node_modules/**]                       │ │
│  │                                                           │ │
│  │ 單次掃描最大檔案數:  [1000]                               │ │
│  └──────────────────────────────────────────────────────────┘ │
│                                                                 │
│  【4. 並行與效能】                                              │
│  ┌──────────────────────────────────────────────────────────┐ │
│  │ ☑ 啟用並行分析  (建議開啟，可提升 40% 效能)               │ │
│  │   並行度: [3──●────10]  (同時分析的檔案數)               │ │
│  │                                                           │ │
│  │ ☑ 啟用智能快取  (減少 API 調用成本)                       │ │
│  │   快取有效期: [24] 小時                                   │ │
│  │   最大快取容量: [10000] 項                                │ │
│  └──────────────────────────────────────────────────────────┘ │
│                                                                 │
│  【5. 成本估算】 ℹ️                                             │
│  ┌──────────────────────────────────────────────────────────┐ │
│  │ 根據當前配置，預估單次掃描成本:                            │ │
│  │                                                           │ │
│  │   OpenAI GPT-4:  $0.08 USD / 掃描 ✅ 符合預算            │ │
│  │   快取命中率:    預估 70% (可節省 $0.24)                  │ │
│  │                                                           │ │
│  │ 💡 提示: 啟用快取和增量掃描可顯著降低成本                  │ │
│  └──────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────┐                      │
│  │  [測試連線]  [重置為預設]  [儲存配置] │                      │
│  └─────────────────────────────────────┘                      │
│                                                                 │
└────────────────────────────────────────────────────────────────┘
```

#### 互動行為

1. **API 金鑰輸入**:
   - 輸入時顯示為密碼遮蔽 (`****`)
   - 點擊 👁️ 圖示可暫時顯示明文
   - 自動驗證格式（以 `sk-` 開頭）
   - 儲存時顯示加密提示

2. **測試連線按鈕**:
   - 點擊後發送測試請求到 AI API
   - 顯示 Loading 動畫和「連線中...」提示
   - 成功: ✅ 綠色提示「連線成功！模型: GPT-4」
   - 失敗: ❌ 紅色錯誤訊息「連線失敗: 無效的 API 金鑰」

3. **滑桿互動**:
   - Temperature 滑桿即時顯示數值
   - 左側顯示「更精確」，右側顯示「更創造」
   - 預設值 0.3（偏向精確）

4. **OWASP 2025 警告**:
   - 勾選時彈出確認對話框
   - 內容: 「OWASP 2025 尚未正式發布，規則可能隨時變更。確定啟用？」
   - 選項: [取消] [了解風險，繼續啟用]

5. **成本估算即時更新**:
   - 當用戶變更配置時（AI 模型、並行度、快取），即時重新計算成本
   - 若成本超過 $0.10，顯示 ⚠️ 警告

#### 驗證規則

```javascript
validation: {
  apiKey: {
    required: true,
    pattern: /^sk-[A-Za-z0-9]{32,}$/,
    message: "請輸入有效的 OpenAI API 金鑰"
  },
  enabledVersions: {
    minSelected: 1,
    message: "至少需選擇一個 OWASP 版本"
  },
  concurrency: {
    min: 1,
    max: 10,
    message: "並行度必須介於 1-10 之間"
  }
}
```

---

### 畫面 2: OWASP 合規報告總覽

**路徑**: `/project/extension/ai-owasp/dashboard`
**權限**: Browse (所有專案成員)
**用途**: 高層次總覽，快速了解專案安全狀況

#### 線框圖描述

```
┌────────────────────────────────────────────────────────────────────┐
│ 🛡️  OWASP 安全報告 - MyProject                                     │
│ 最後掃描: 2025-10-19 14:30 (2 小時前)  OWASP 2021  [重新掃描]      │
├────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  【執行摘要】                                                       │
│  ┌───────────────────────────────────────────────────────────────┐│
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      ││
│  │  │   🚨     │  │   ⚠️     │  │   ⚡     │  │   ℹ️     │      ││
│  │  │    3     │  │   12     │  │   24     │  │    8     │      ││
│  │  │ Critical │  │   High   │  │  Medium  │  │   Low    │      ││
│  │  └──────────┘  └──────────┘  └──────────┘  └──────────┘      ││
│  │                                                                ││
│  │  總漏洞數: 47     掃描檔案: 342 / 342     AI 分析: 已完成     ││
│  │  合規狀態: ⚠️ 需注意  (3 個嚴重漏洞需立即修復)                 ││
│  │                                                                ││
│  │  整體風險評分: [████████░░] 78 / 100  (高風險)                ││
│  └────────────────────────────────────────────────────────────────┘│
│                                                                     │
│  【快速操作】                                                       │
│  [📊 查看詳細報告]  [🔄 多版本對照]  [📥 匯出報告]  [⚙️ 配置]    │
│                                                                     │
│  【OWASP 類別分佈】                                                 │
│  ┌────────────────────────────────────────────────────────────────┐│
│  │                                                                 ││
│  │  ┌─ 圓餅圖 ─────────────────────────────────────────┐          ││
│  │  │                                                   │          ││
│  │  │       A03: Injection (28%)                        │          ││
│  │  │       A01: Broken Access Control (21%)            │          ││
│  │  │       A02: Cryptographic Failures (15%)           │          ││
│  │  │       A07: Identification Failures (12%)          │          ││
│  │  │       其他 (24%)                                  │          ││
│  │  │                                                   │          ││
│  │  └───────────────────────────────────────────────────┘          ││
│  │                                                                 ││
│  └─────────────────────────────────────────────────────────────────┘│
│                                                                     │
│  【Top 5 需優先修復的漏洞】                                         │
│  ┌────────────────────────────────────────────────────────────────┐│
│  │ 1. 🚨 SQL Injection in UserController.java:45                  ││
│  │    A03:2021-Injection | CWE-89 | Critical                      ││
│  │    影響: 可能導致資料庫完全洩露                                 ││
│  │    AI 建議: 使用 PreparedStatement 取代字串拼接 (2-4小時)      ││
│  │    [查看詳情] [查看修復建議]                                    ││
│  │                                                                 ││
│  │ 2. 🚨 Hardcoded API Key in ConfigService.java:23               ││
│  │    A02:2021-Cryptographic Failures | CWE-798 | Critical        ││
│  │    [查看詳情]                                                   ││
│  │                                                                 ││
│  │ 3. ⚠️ Missing Authorization Check in AdminAPI.java:67          ││
│  │    A01:2021-Broken Access Control | CWE-284 | High             ││
│  │    [查看詳情]                                                   ││
│  │                                                                 ││
│  │ ... (顯示前 5 個)                                               ││
│  │                                                                 ││
│  │ [查看全部 47 個漏洞]                                            ││
│  └─────────────────────────────────────────────────────────────────┘│
│                                                                     │
│  【修復進度追蹤】 (Phase 2 功能)                                    │
│  ┌────────────────────────────────────────────────────────────────┐│
│  │ 已修復: 5    進行中: 3    待處理: 39                            ││
│  │ [████░░░░░░░░░░░░░░░░] 10.6% 完成                               ││
│  └─────────────────────────────────────────────────────────────────┘│
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 關鍵設計要點

1. **視覺層級**:
   - 最大且最醒目: Critical 漏洞數量（紅色、大字）
   - 第二層級: 整體風險評分（進度條 + 顏色編碼）
   - 第三層級: Top 5 漏洞列表（可操作）

2. **顏色編碼**:
   - Critical (紅色): 吸引立即注意
   - High (橙色): 次高優先級
   - Medium (黃色): 中等注意
   - Low (灰色): 低視覺權重

3. **可操作性**:
   - 每個漏洞都有 [查看詳情] 和 [查看修復建議] 按鈕
   - [重新掃描] 按鈕顯示預估時間（「約 5-8 分鐘」）
   - [匯出報告] 支援 HTML 和 JSON 格式

4. **即時資訊**:
   - 顯示「最後掃描時間」和「相對時間」（2 小時前）
   - 合規狀態自動評估（✅ 良好、⚠️ 需注意、🚨 嚴重）

---

### 畫面 3: 單版本報告頁面

**路徑**: `/project/extension/ai-owasp/report?version=2021`
**用途**: 顯示單一 OWASP 版本的完整報告

#### 線框圖描述

```
┌────────────────────────────────────────────────────────────────────┐
│ 📄 OWASP Top 10 2021 安全報告 - MyProject                          │
│ [ ◀ 返回總覽 ]   版本: [ OWASP 2021 ▼ ]   [📥 匯出] [🔄 多版本對照]│
├────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  【快速過濾】                                                       │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ 🔍 搜尋漏洞...  [                                          ] │ │
│  │                                                              │ │
│  │ 嚴重性: [全部 ▼]  OWASP 類別: [全部 ▼]  檔案: [全部 ▼]     │ │
│  │                                                              │ │
│  │ 已選擇篩選器: [ Critical × ] [ A03:Injection × ]            │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【OWASP Top 10 2021 類別列表】 (顯示 3 / 10 個類別有漏洞)         │
│                                                                     │
│  ┌─ A01:2021 - Broken Access Control ───────────── 10 個漏洞 ────┐│
│  │  ⚠️ High (6)   ⚡ Medium (4)                                   ││
│  │  CWE Mapping: CWE-22, CWE-35, CWE-284                          ││
│  │  [展開漏洞列表 ▼]                                              ││
│  └─────────────────────────────────────────────────────────────────┘│
│                                                                     │
│  ┌─ A02:2021 - Cryptographic Failures ──────────── 7 個漏洞 ─────┐│
│  │  🚨 Critical (2)   ⚠️ High (3)   ⚡ Medium (2)                 ││
│  │  CWE Mapping: CWE-259, CWE-327, CWE-329                        ││
│  │  [展開漏洞列表 ▼]                                              ││
│  └─────────────────────────────────────────────────────────────────┘│
│                                                                     │
│  ┌─ A03:2021 - Injection ─────────────────────── 13 個漏洞 ──────┐│
│  │  🚨 Critical (1)   ⚠️ High (5)   ⚡ Medium (7)                 ││
│  │  CWE Mapping: CWE-79, CWE-89, CWE-917                          ││
│  │  [收合漏洞列表 ▲]                                              ││
│  │                                                                 ││
│  │  ┌────────────────────────────────────────────────────────────┐││
│  │  │ 1. 🚨 SQL Injection in UserController.java:45             │││
│  │  │    CWE-89 | Critical | 檢測時間: 2025-10-19 14:25         │││
│  │  │                                                            │││
│  │  │    描述: 在用戶查詢功能中直接拼接 SQL 字串，未進行參數化   │││
│  │  │    處理，可能導致 SQL Injection 攻擊。                     │││
│  │  │                                                            │││
│  │  │    代碼位置:                                               │││
│  │  │    ```java                                                 │││
│  │  │    String sql = "SELECT * FROM users WHERE id = "         │││
│  │  │                 + userId;  // ⚠️ 危險！                    │││
│  │  │    ```                                                     │││
│  │  │                                                            │││
│  │  │    ✨ AI 修復建議 (預估工作量: 2-4 小時)                    │││
│  │  │    [展開建議 ▼]                                            │││
│  │  │                                                            │││
│  │  │    [查看完整詳情] [標記為誤報] [已修復]                    │││
│  │  └────────────────────────────────────────────────────────────┘││
│  │                                                                 ││
│  │  ┌────────────────────────────────────────────────────────────┐││
│  │  │ 2. ⚠️ XSS Vulnerability in CommentService.java:89         │││
│  │  │    CWE-79 | High | 檢測時間: 2025-10-19 14:26             │││
│  │  │    [展開詳情 ▼]                                            │││
│  │  └────────────────────────────────────────────────────────────┘││
│  │                                                                 ││
│  │  ... (顯示所有 13 個漏洞)                                       ││
│  │                                                                 ││
│  └─────────────────────────────────────────────────────────────────┘│
│                                                                     │
│  ┌─ A04:2021 - Insecure Design ──────────────────── 無漏洞 ──────┐│
│  │  ✅ 此類別未檢測到漏洞                                          ││
│  └─────────────────────────────────────────────────────────────────┘│
│                                                                     │
│  ... (其他 6 個類別)                                                │
│                                                                     │
│  [載入更多類別]                                                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 互動行為

1. **摺疊/展開類別**:
   - 預設: 有漏洞的類別展開，無漏洞的收合
   - 點擊類別標題可切換展開/收合狀態
   - 展開時顯示所有漏洞列表
   - 使用平滑動畫（300ms ease-in-out）

2. **快速過濾**:
   - 即時過濾（無需提交）
   - 搜尋框支援模糊搜尋（檔名、描述、CWE ID）
   - 多重篩選器疊加（AND 邏輯）
   - 顯示「已選擇篩選器」標籤，可快速移除

3. **漏洞卡片互動**:
   - Hover 時顯示陰影效果
   - 點擊卡片任意位置展開完整詳情
   - [標記為誤報] 需要確認對話框
   - [已修復] 標記後移至「已修復」分類

4. **AI 修復建議展開**:
   - 預設收合，點擊 [展開建議 ▼] 展開
   - 展開後顯示完整修復步驟和 Before/After 代碼
   - 提供 [複製代碼] 按鈕

---

### 畫面 4: 多版本對照頁面

**路徑**: `/project/extension/ai-owasp/comparison?versions=2017,2021,2025`
**用途**: 並排比較 2-3 個 OWASP 版本的差異

**詳見後續專門章節: [多版本對照報告設計](#多版本對照報告設計)**

---

### 畫面 5: 漏洞詳情頁面

**路徑**: `/project/extension/ai-owasp/vulnerability/{id}`
**用途**: 顯示單一漏洞的完整資訊和 AI 修復建議

**詳見後續專門章節: [漏洞詳情頁面設計](#漏洞詳情頁面設計)**

---

### 畫面 6: 掃描進度頁面

**路徑**: `/project/extension/ai-owasp/scan-progress`
**用途**: 即時顯示掃描進度，提供效能感知

#### 線框圖描述

```
┌────────────────────────────────────────────────────────────────────┐
│ 🔄 正在掃描專案...                                                  │
├────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  【整體進度】                                                       │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │                                                              │ │
│  │  ████████████████████░░░░░░░░░░░░░░░░░░░░░  62%             │ │
│  │                                                              │ │
│  │  已分析: 212 / 342 個檔案                                    │ │
│  │  預估剩餘時間: 約 3 分鐘                                     │ │
│  │                                                              │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【當前任務】                                                       │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │  🔍 正在分析: src/services/UserService.java                  │ │
│  │  ⏱️  已用時: 12 秒                                            │ │
│  │                                                              │ │
│  │  並行任務:                                                   │ │
│  │  • Thread 1: ✅ PaymentController.java (完成)                │ │
│  │  • Thread 2: 🔄 UserService.java (進行中)                    │ │
│  │  • Thread 3: 🔄 AuthService.java (進行中)                    │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【即時統計】                                                       │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │  已檢測漏洞:   47 個                                          │ │
│  │  快取命中率:   72%  (節省 154 次 AI 調用)                    │ │
│  │  平均分析時間: 18 秒/檔案                                     │ │
│  │  預估成本:     $0.06 USD                                      │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【活動日誌】 (最近 5 筆)                                           │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ 14:32:15  ✅ 完成分析 PaymentController.java (2 個漏洞)      │ │
│  │ 14:32:10  🔄 開始分析 UserService.java                       │ │
│  │ 14:32:08  ✅ 完成分析 OrderService.java (快取命中)           │ │
│  │ 14:32:05  🔄 開始分析 AuthService.java                       │ │
│  │ 14:32:02  ✅ 完成分析 ProductController.java (5 個漏洞)     │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  [暫停掃描]  [取消掃描]                                             │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 互動行為

1. **即時更新**:
   - 使用 WebSocket 或輪詢（每 2 秒）更新進度
   - 進度條平滑動畫
   - 活動日誌自動滾動到最新項目

2. **並行任務視覺化**:
   - 顯示 3 個並行執行緒的狀態
   - ✅ 完成（綠色）、🔄 進行中（藍色動畫）、⏳ 等待（灰色）

3. **暫停/取消功能**:
   - [暫停掃描]: 停止新任務，等待當前任務完成
   - [取消掃描]: 確認對話框 → 立即停止所有任務

4. **完成後行為**:
   - 自動跳轉到報告總覽頁面（3 秒倒數）
   - 顯示完成摘要: 「✅ 掃描完成！共檢測到 47 個漏洞，耗時 8 分 32 秒」

---

### 畫面 7: 報告匯出頁面

**路徑**: `/project/extension/ai-owasp/export`
**用途**: 配置並匯出報告檔案

#### 線框圖描述

```
┌────────────────────────────────────────────────────────────────────┐
│ 📥 匯出 OWASP 安全報告                                              │
├────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  【1. 選擇報告類型】                                                │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ ⦿ 單版本報告   ○ 多版本對照報告                              │ │
│  │                                                              │ │
│  │ OWASP 版本: [ OWASP 2021 ▼ ]                                │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【2. 選擇匯出格式】                                                │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ ⦿ HTML (包含圖表和互動元素)                                  │ │
│  │ ○ JSON (結構化資料，適合 API 整合)                          │ │
│  │ ○ PDF (Phase 2 功能)                                        │ │
│  │ ○ Markdown (Phase 2 功能)                                   │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【3. 報告內容選項】                                                │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ ☑ 執行摘要                                                   │ │
│  │ ☑ OWASP 類別分佈圖表                                         │ │
│  │ ☑ 漏洞詳情列表                                               │ │
│  │ ☑ AI 修復建議                                                │ │
│  │ ☑ 代碼片段                                                   │ │
│  │ ☑ CWE 映射表                                                 │ │
│  │ ☐ 掃描日誌 (僅 JSON 格式)                                   │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【4. 篩選條件】 (選填)                                             │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ 僅匯出以下嚴重性:                                            │ │
│  │ ☑ Critical   ☑ High   ☐ Medium   ☐ Low                     │ │
│  │                                                              │ │
│  │ OWASP 類別篩選: [全部 ▼]                                    │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【5. 預覽與匯出】                                                  │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ 預覽報告:                                                    │ │
│  │                                                              │ │
│  │ 檔案名稱: owasp-2021-report-20251019.html                   │ │
│  │ 預估大小: 2.4 MB                                             │ │
│  │ 包含內容: 47 個漏洞, 15 個 AI 修復建議                       │ │
│  │                                                              │ │
│  │ [📄 預覽報告]  [📥 下載報告]                                 │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 互動行為

1. **格式選擇聯動**:
   - 選擇 JSON 格式時，自動啟用 [掃描日誌] 選項
   - HTML 格式自動包含 CSS 和 Chart.js

2. **預覽功能**:
   - [預覽報告]: 在新分頁開啟報告預覽
   - 預覽模式顯示浮水印: 「預覽模式 - 非最終版本」

3. **下載行為**:
   - 點擊 [下載報告] 開始生成報告
   - 顯示進度條: 「生成中... 45%」
   - 完成後自動下載檔案
   - 瀏覽器下載提示: 「✅ 報告已下載: owasp-2021-report-20251019.html」

---

## 互動流程圖

### 完整用戶旅程

```
┌─────────────────────────────────────────────────────────────────┐
│                        User Journey Flow                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  新用戶首次使用                                                  │
│  ─────────────────                                               │
│                                                                  │
│  1. 管理員安裝插件                                               │
│     ↓                                                            │
│  2. 進入插件配置頁面                                             │
│     • 配置 AI API 金鑰                                           │
│     • 選擇 OWASP 版本                                            │
│     • 測試連線                                                   │
│     ↓                                                            │
│  3. 儲存配置                                                     │
│     ↓                                                            │
│  4. 返回專案頁面                                                 │
│     ↓                                                            │
│  5. 點擊「執行 OWASP 掃描」按鈕                                  │
│     ↓                                                            │
│  6. 掃描進度頁面                                                 │
│     • 即時顯示進度                                               │
│     • 顯示並行任務                                               │
│     • 預估剩餘時間                                               │
│     ↓ (完成)                                                     │
│  7. 自動跳轉到報告總覽頁面                                       │
│     • 查看執行摘要                                               │
│     • 識別 Critical 漏洞                                         │
│     ↓                                                            │
│  8. 點擊某個漏洞 → 漏洞詳情頁面                                  │
│     • 查看詳細描述                                               │
│     • 查看代碼片段                                               │
│     • 展開 AI 修復建議                                           │
│     ↓                                                            │
│  9. 複製修復代碼 → 應用到專案中                                  │
│     ↓                                                            │
│  10. 標記為「已修復」                                            │
│      ↓                                                           │
│  11. 重新掃描驗證                                                │
│                                                                  │
│                                                                  │
│  進階用戶流程                                                    │
│  ────────────                                                     │
│                                                                  │
│  A. 多版本對照                                                   │
│     1. 從報告總覽點擊 [多版本對照]                               │
│     2. 選擇要比較的版本 (e.g., 2017 vs 2021)                    │
│     3. 查看並排對照報告                                          │
│     4. 識別版本間差異                                            │
│     5. 匯出對照報告                                              │
│                                                                  │
│  B. 報告匯出                                                     │
│     1. 從任意報告頁面點擊 [匯出報告]                             │
│     2. 選擇格式 (HTML / JSON)                                    │
│     3. 配置內容選項                                              │
│     4. 預覽報告                                                  │
│     5. 下載報告檔案                                              │
│                                                                  │
│  C. 持續監控 (CI/CD 整合)                                        │
│     1. 每次 Push 自動觸發掃描                                    │
│     2. CI/CD 管道執行掃描                                        │
│     3. 若有 Critical/High 漏洞 → 構建失敗                        │
│     4. 開發者在 SonarQube 查看報告                               │
│     5. 修復漏洞 → Push → 重新掃描                                │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

### 關鍵互動決策樹

```
用戶進入報告總覽頁面
   │
   ├─ 發現 Critical 漏洞？
   │  ├─ 是 → 點擊漏洞 → 漏洞詳情頁面
   │  │      ├─ 查看 AI 修復建議
   │  │      ├─ 複製修復代碼
   │  │      └─ 標記為「處理中」
   │  │
   │  └─ 否 → 查看整體統計
   │         ├─ 滿意結果 → 匯出報告
   │         └─ 需要深入分析 → 查看單版本報告
   │
   ├─ 需要比較不同版本？
   │  └─ 是 → 點擊「多版本對照」
   │         ├─ 選擇版本組合
   │         ├─ 查看差異分析
   │         └─ 匯出對照報告
   │
   └─ 需要調整配置？
      └─ 是 → 點擊「配置」
             ├─ 修改 AI 模型
             ├─ 調整掃描範圍
             └─ 儲存並重新掃描
```

---

## 多版本對照報告設計

### 設計挑戰

1. **資訊密度高**: 3 個版本並排顯示，如何避免視覺混亂？
2. **差異高亮**: 如何清晰標示新增、移除、變更的類別？
3. **類別映射**: 如何直觀展示跨版本的類別對應關係？
4. **互動複雜度**: 如何讓用戶輕鬆在不同版本間切換和比較？

### 解決方案

#### 1. 並排三欄佈局

```
┌────────────────────────────────────────────────────────────────────┐
│ 🔄 多版本對照報告                                                   │
│ [ OWASP 2017 ]  vs  [ OWASP 2021 ]  vs  [ OWASP 2025 (Preview) ]  │
├────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  【統計摘要】                                                       │
│  ┌─────────────────┬─────────────────┬──────────────────┐         │
│  │   OWASP 2017    │   OWASP 2021    │   OWASP 2025     │         │
│  ├─────────────────┼─────────────────┼──────────────────┤         │
│  │ 漏洞總數: 42    │ 漏洞總數: 47    │ 漏洞總數: 51     │         │
│  │ Critical: 3     │ Critical: 3     │ Critical: 4      │         │
│  │ High: 10        │ High: 12        │ High: 14         │         │
│  │ Medium: 21      │ Medium: 24      │ Medium: 25       │         │
│  │ Low: 8          │ Low: 8          │ Low: 8           │         │
│  └─────────────────┴─────────────────┴──────────────────┘         │
│                                                                     │
│  【類別對照表】                                                     │
│  ┌─────────────────────────────────────────────────────────────┐  │
│  │                                                             │  │
│  │  2017                     2021                     2025     │  │
│  │  ────────────────────────────────────────────────────────  │  │
│  │                                                             │  │
│  │  A1: Injection  ─────────▶ A03: Injection ─────────▶ A03   │  │
│  │  (13 個漏洞)              (13 個漏洞)              (15)     │  │
│  │                                                             │  │
│  │  A2: Broken Auth ────────▶ A07: ID Failures ───────▶ A02   │  │
│  │  (7 個漏洞)               (6 個漏洞)               (8)      │  │
│  │                                                             │  │
│  │  A3: Sensitive Data ─────▶ A02: Crypto Failures ───▶ A01   │  │
│  │  (5 個漏洞)               (7 個漏洞)               (6)      │  │
│  │                                                             │  │
│  │  [無對應] ───────────────▶ A01: Access Control ────▶ A04   │  │
│  │                           (10 個漏洞) 🆕           (12)     │  │
│  │                                                             │  │
│  │  A10: Logging ───────────▶ A09: Logging Failures ──▶ [移除]│  │
│  │  (2 個漏洞)               (3 個漏洞)               ❌       │  │
│  │                                                             │  │
│  │  ... (展開其他類別)                                        │  │
│  │                                                             │  │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                     │
│  【差異分析】                                                       │
│  ┌─────────────────────────────────────────────────────────────┐  │
│  │                                                             │  │
│  │  📊 2017 → 2021 變化:                                       │  │
│  │  • 新增類別: A01 (Broken Access Control) 🆕                │  │
│  │  • 移除類別: 無                                             │  │
│  │  • 重新排序: A1 Injection 從第 1 降至第 3                   │  │
│  │  • 漏洞數變化: +5 個 (42 → 47)                             │  │
│  │                                                             │  │
│  │  📊 2021 → 2025 變化:                                       │  │
│  │  • 新增類別: [預測] A11 (AI Security Risks) 🆕             │  │
│  │  • 移除類別: A09 (Security Logging Failures) ❌            │  │
│  │  • 重新排序: A02 從第 2 升至第 1                            │  │
│  │  • 漏洞數變化: +4 個 (47 → 51)                             │  │
│  │                                                             │  │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                     │
│  【詳細漏洞對照】 (可選展開)                                       │
│  ┌─────────────────────────────────────────────────────────────┐  │
│  │ 選擇類別查看詳細對照:                                       │  │
│  │ [ A03: Injection ▼ ]                                        │  │
│  │                                                             │  │
│  │  ┌──────────────┬──────────────┬───────────────┐           │  │
│  │  │ 2017 (13個) │ 2021 (13個) │ 2025 (15個)  │           │  │
│  │  ├──────────────┼──────────────┼───────────────┤           │  │
│  │  │ SQL Inj.     │ SQL Inj.     │ SQL Inj.      │           │  │
│  │  │ UserCtrl:45  │ UserCtrl:45  │ UserCtrl:45   │           │  │
│  │  │ (相同漏洞)   │ (相同漏洞)   │ (相同漏洞)    │           │  │
│  │  ├──────────────┼──────────────┼───────────────┤           │  │
│  │  │ XSS Comment  │ XSS Comment  │ XSS Comment   │           │  │
│  │  │ :89          │ :89          │ :89           │           │  │
│  │  ├──────────────┼──────────────┼───────────────┤           │  │
│  │  │ [無]         │ [無]         │ NoSQL Inj. 🆕 │           │  │
│  │  │              │              │ MongoDB:102   │           │  │
│  │  └──────────────┴──────────────┴───────────────┘           │  │
│  │                                                             │  │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                     │
│  [📥 匯出對照報告]                                                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 2. 視覺設計要點

**顏色編碼**:
```css
/* 版本標識 */
.version-2017 { border-left: 4px solid #007BFF; background: #E7F3FF; }
.version-2021 { border-left: 4px solid #28A745; background: #E8F5E9; }
.version-2025 { border-left: 4px solid #FF6B35; background: #FFF3E0; }

/* 差異標記 */
.new-category   { background: #D4EDDA; border: 2px dashed #28A745; }
.removed-category { background: #F8D7DA; border: 2px dashed #DC3545; opacity: 0.6; }
.changed-category { background: #FFF3CD; border: 2px solid #FFC107; }
```

**類別映射箭頭**:
```
使用 SVG 繪製連接線：
• 直線箭頭: 類別名稱和排序未變
• 曲線箭頭: 類別重新排序
• 虛線箭頭: 類別名稱變更
• 雙向箭頭: 類別合併或拆分
```

#### 3. 互動行為

1. **版本切換**:
   - 頂部版本選擇器可動態切換比較的版本
   - 支援 2 個版本或 3 個版本對照
   - 切換時保留當前捲動位置

2. **類別映射互動**:
   - Hover 箭頭時高亮連接的兩個類別
   - 點擊類別展開詳細漏洞對照
   - 顯示 Tooltip: 「A1:2017 → A03:2021 (排序變更: 1 → 3)」

3. **差異高亮**:
   - 新增類別顯示 🆕 圖示和綠色邊框
   - 移除類別顯示 ❌ 圖示和紅色邊框，降低透明度
   - 變更類別顯示 ⚠️ 圖示和黃色邊框

4. **響應式行為**:
   - 桌面（≥1280px）: 三欄並排
   - 平板（768-1279px）: 兩欄並排 + 第三欄摺疊
   - 手機（<768px）: 單欄 + 標籤頁切換

---

## 漏洞詳情頁面設計

### 設計目標

1. **資訊完整**: 包含所有必要資訊（描述、代碼、影響、修復）
2. **操作便利**: 提供一鍵複製、跳轉到代碼、標記狀態等操作
3. **視覺清晰**: 使用卡片式佈局，避免資訊過載
4. **AI 建議突出**: 修復建議是核心價值，需視覺突出

### 詳細線框圖

```
┌────────────────────────────────────────────────────────────────────┐
│ 🚨 漏洞詳情: SQL Injection in UserController.java                  │
│ [ ◀ 返回報告 ]                                    [標記為誤報 ▼]   │
├────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  【基本資訊】                                                       │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ OWASP 類別:  A03:2021 - Injection                            │ │
│  │ CWE ID:      CWE-89 (Improper SQL Query Neutralization)     │ │
│  │ 嚴重性:      🚨 Critical                                     │ │
│  │ 檢測時間:    2025-10-19 14:25:32                             │ │
│  │ 狀態:        ⏳ 待處理  [ 變更狀態 ▼ ]                       │ │
│  │ 檔案位置:    src/controllers/UserController.java:45         │ │
│  │              [在 IDE 中開啟 🔗]                               │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【漏洞描述】                                                       │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ 在用戶查詢功能中，直接將用戶輸入的 userId 參數拼接到 SQL      │ │
│  │ 字串中，未進行任何驗證或參數化處理。攻擊者可透過構造惡意     │ │
│  │ 輸入（如 `1 OR 1=1`）來執行任意 SQL 命令。                   │ │
│  │                                                              │ │
│  │ 🎯 攻擊向量:                                                  │ │
│  │ • 參數注入: userId = "1 OR 1=1"                              │ │
│  │ • 預期行為: 查詢 ID 為 1 的用戶                              │ │
│  │ • 實際行為: 返回所有用戶資料                                 │ │
│  │                                                              │ │
│  │ ⚠️ 潛在影響:                                                  │ │
│  │ • 資料洩露: 攻擊者可讀取整個資料庫                           │ │
│  │ • 資料篡改: 可能執行 UPDATE/DELETE 操作                      │ │
│  │ • 權限提升: 可能修改管理員帳號資訊                           │ │
│  │ • 業務衝擊: 高 - 可能導致重大資料洩露事件                    │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【受影響的代碼】                                                   │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ UserController.java:43-47                    [複製代碼 📋]   │ │
│  │ ┌────────────────────────────────────────────────────────┐   │ │
│  │ │ 43  public User getUserById(String userId) {           │   │ │
│  │ │ 44      Connection conn = getConnection();             │   │ │
│  │ │ 45 ⚠️   String sql = "SELECT * FROM users WHERE id = " │   │ │
│  │ │                      + userId;  // 🚨 SQL Injection!   │   │ │
│  │ │ 46      ResultSet rs = conn.executeQuery(sql);         │   │ │
│  │ │ 47      return mapToUser(rs);                          │   │ │
│  │ │ 48  }                                                  │   │ │
│  │ └────────────────────────────────────────────────────────┘   │ │
│  │                                                              │ │
│  │ 💡 問題所在: 第 45 行直接拼接用戶輸入，未使用參數化查詢      │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【✨ AI 修復建議】                                                 │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ 由 Claude AI 生成 • 置信度: 95% • 預估工作量: 2-4 小時      │ │
│  ├──────────────────────────────────────────────────────────────┤ │
│  │                                                              │ │
│  │ 📝 修復步驟:                                                  │ │
│  │                                                              │ │
│  │ 1️⃣ 將字串拼接改為 PreparedStatement 參數化查詢               │ │
│  │ 2️⃣ 新增輸入驗證（驗證 userId 為有效的數字格式）              │ │
│  │ 3️⃣ 實施最小權限原則（資料庫帳號僅授予 SELECT 權限）          │ │
│  │ 4️⃣ 新增日誌記錄異常的查詢嘗試                                │ │
│  │ 5️⃣ 撰寫單元測試驗證修復效果                                  │ │
│  │                                                              │ │
│  │ ▼ Before (危險代碼)                                          │ │
│  │ ┌────────────────────────────────────────────────────────┐   │ │
│  │ │ String sql = "SELECT * FROM users WHERE id = "         │   │ │
│  │ │              + userId;  // ❌ 不安全                    │   │ │
│  │ │ ResultSet rs = conn.executeQuery(sql);                 │   │ │
│  │ └────────────────────────────────────────────────────────┘   │ │
│  │                                                              │ │
│  │ ▼ After (安全代碼)                        [複製修復代碼 📋] │ │
│  │ ┌────────────────────────────────────────────────────────┐   │ │
│  │ │ // 1. 使用 PreparedStatement                           │   │ │
│  │ │ String sql = "SELECT * FROM users WHERE id = ?";       │   │ │
│  │ │ PreparedStatement pstmt = conn.prepareStatement(sql);  │   │ │
│  │ │                                                        │   │ │
│  │ │ // 2. 輸入驗證                                         │   │ │
│  │ │ if (!userId.matches("\\d+")) {                        │   │ │
│  │ │     throw new IllegalArgumentException(               │   │ │
│  │ │         "Invalid user ID format");                    │   │ │
│  │ │ }                                                      │   │ │
│  │ │                                                        │   │ │
│  │ │ // 3. 參數化查詢                                       │   │ │
│  │ │ pstmt.setInt(1, Integer.parseInt(userId));            │   │ │
│  │ │ ResultSet rs = pstmt.executeQuery();                  │   │ │
│  │ │                                                        │   │ │
│  │ │ // 4. 日誌記錄                                         │   │ │
│  │ │ logger.info("User query executed: userId={}", userId);│   │ │
│  │ └────────────────────────────────────────────────────────┘   │ │
│  │                                                              │ │
│  │ 📊 工作量評估:                                                │ │
│  │ • 複雜度: 簡單 ✅                                             │ │
│  │ • 預估時間: 2-4 小時                                          │ │
│  │ • 需要技能: Java, JDBC, SQL                                  │ │
│  │ • 測試時間: 1 小時                                            │ │
│  │                                                              │ │
│  │ 🔗 參考資源:                                                  │ │
│  │ • OWASP SQL Injection Prevention Cheat Sheet                │ │
│  │ • Java PreparedStatement 官方文件                            │ │
│  │ • CWE-89 詳細說明                                             │ │
│  │                                                              │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【相關漏洞】 (同類別)                                              │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │ • XSS in CommentService.java:89 (A03:Injection)             │ │
│  │ • Command Injection in FileUpload.java:112 (A03:Injection)  │ │
│  │ [查看全部 A03 類別漏洞]                                      │ │
│  └──────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  【操作】                                                           │
│  [✅ 標記為已修復]  [⏳ 標記為處理中]  [📋 建立 Jira Issue]        │
│  [📤 分享給團隊]    [🚫 標記為誤報]                                │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 關鍵 UX 設計

#### 1. 資訊層級

```
視覺權重排序:
1. 嚴重性標籤 (最大、最醒目)
2. 漏洞描述與影響
3. 受影響的代碼片段
4. AI 修復建議 (突出顯示)
5. 相關漏洞與操作按鈕
```

#### 2. 代碼展示

- 使用 Prism.js 語法高亮
- 問題行標註紅色背景 + ⚠️ 圖示
- 行號顯示，方便定位
- [複製代碼] 按鈕，點擊後顯示「✅ 已複製」提示

#### 3. AI 建議卡片

```css
.ai-suggestion-card {
    border: 2px solid #4B9FD5;
    border-radius: 8px;
    padding: 24px;
    background: linear-gradient(135deg, #EAF4FB 0%, #FFFFFF 100%);
    box-shadow: 0 4px 12px rgba(75, 159, 213, 0.2);
}

.ai-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px;
    background: #4B9FD5;
    color: white;
    border-radius: 16px;
    font-size: 12px;
    font-weight: 600;
}
```

#### 4. Before/After 對比

使用左右分欄佈局：

```
┌─────────────────────────────────────┐
│ Before (危險代碼)  │  After (安全代碼) │
├────────────────────┼────────────────────┤
│ String sql =       │ String sql =       │
│   "SELECT * FROM   │   "SELECT * FROM   │
│   users WHERE      │   users WHERE      │
│   id = " + userId; │   id = ?";         │
│ ❌ 不安全           │ ✅ 安全             │
└─────────────────────────────────────┘
```

- 左側（Before）: 淡紅色背景 (#FFF5F5)
- 右側（After）: 淡綠色背景 (#F0FFF4)
- 差異行高亮

#### 5. 狀態變更互動

```
[變更狀態 ▼] 下拉選單:
┌──────────────────────┐
│ ⏳ 待處理 (當前)     │
│ 🔄 處理中            │
│ ✅ 已修復            │
│ 🚫 誤報              │
│ ⏸️  延後處理         │
└──────────────────────┘
```

- 選擇狀態後彈出確認對話框
- 若選擇「已修復」，提示「是否重新掃描驗證？」
- 狀態變更記錄到審計日誌

---

## 配置頁面 UX 設計

### 設計目標

1. **降低複雜度**: 配置選項多但不能讓用戶感到overwhelmed
2. **合理預設值**: 提供智能預設值，90% 用戶無需修改
3. **即時反饋**: 配置變更立即顯示影響（成本估算、效能預測）
4. **分步引導**: 新用戶首次配置時提供引導流程

### 配置頁面已在「畫面 1」詳述，補充以下設計要點：

#### 1. 配置分組與收合

```
【1. AI 模型配置】 ▼ (預設展開)
    • AI 供應商選擇
    • API 金鑰
    • 進階參數 (摺疊)

【2. OWASP 版本配置】 ▼ (預設展開)
    • 啟用的版本
    • 預設版本

【3. 掃描配置】 ▲ (預設收合)
    • 掃描模式
    • 包含/排除路徑

【4. 並行與效能】 ▲ (預設收合)
    • 並行分析設定
    • 智能快取設定

【5. 成本估算】 ▲ (預設收合，資訊面板)
```

#### 2. 首次配置引導

```
Step 1/4: 選擇 AI 供應商
┌────────────────────────────────────┐
│ 請選擇您要使用的 AI 供應商:         │
│                                    │
│ ○ OpenAI GPT-4                     │
│   推薦：速度快、準確率高            │
│   成本：約 $0.08/掃描               │
│                                    │
│ ○ Anthropic Claude                 │
│   推薦：深度分析、低誤報            │
│   成本：約 $0.10/掃描               │
│                                    │
│ [上一步]  [下一步: 輸入 API 金鑰]  │
└────────────────────────────────────┘
```

- 4 步驟引導: AI 供應商 → API 金鑰 → OWASP 版本 → 測試連線
- 每步顯示進度條: ████░░░░ 50%
- 可跳過引導，直接進入完整配置

#### 3. 智能預設值

```javascript
默認配置:
{
  aiProvider: "OPENAI",          // 最流行
  owaspVersions: ["2021"],        // 僅預設版本
  scanMode: "FULL",               // 首次掃描完整
  parallelEnabled: true,          // 效能優化
  concurrency: 3,                 // 平衡效能與資源
  cacheEnabled: true,             // 降低成本
  cacheTTL: 86400,                // 24小時
  temperature: 0.3,               // 偏向精確
  maxTokens: 2000,                // 平衡成本與品質
  timeout: 60                     // 預防超時
}
```

#### 4. 即時驗證與提示

```
API 金鑰輸入框:
┌────────────────────────────────────┐
│ [sk-proj-...] ⚠️ 金鑰格式正確，     │
│               但尚未測試連線        │
│                                    │
│ [測試連線] ← 點擊驗證               │
└────────────────────────────────────┘

測試連線中:
┌────────────────────────────────────┐
│ 🔄 正在連線到 OpenAI API...        │
│    (約需 3-5 秒)                   │
└────────────────────────────────────┘

測試成功:
┌────────────────────────────────────┐
│ ✅ 連線成功！                       │
│    模型: gpt-4-turbo               │
│    配額剩餘: $45.32                │
└────────────────────────────────────┘

測試失敗:
┌────────────────────────────────────┐
│ ❌ 連線失敗                         │
│    錯誤: Invalid API key           │
│                                    │
│ 💡 請檢查:                          │
│ • API 金鑰是否正確                  │
│ • 帳號是否有足夠配額                │
│ • 網路連線是否正常                  │
└────────────────────────────────────┘
```

---

## 無障礙性實現

### WCAG 2.1 AA 合規

#### 1. 鍵盤導航

**完整鍵盤支援**:
```
Tab        → 移動到下一個可互動元素
Shift+Tab  → 移動到上一個可互動元素
Enter      → 觸發按鈕或展開/收合
Space      → 勾選 checkbox 或選擇 radio
Esc        → 關閉對話框或下拉選單
Arrow Keys → 在下拉選單或標籤頁間導航
```

**焦點指示器**:
```css
:focus {
    outline: 3px solid #4B9FD5;
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(75, 159, 213, 0.25);
}

/* 滑鼠用戶不顯示焦點框 */
:focus:not(:focus-visible) {
    outline: none;
}

:focus-visible {
    outline: 3px solid #4B9FD5;
    outline-offset: 2px;
}
```

#### 2. 螢幕閱讀器支援

**ARIA 標籤範例**:
```html
<!-- 漏洞嚴重性標籤 -->
<span class="severity-critical" role="status" aria-label="Critical severity">
    🚨 Critical
</span>

<!-- 進度條 -->
<div role="progressbar"
     aria-valuenow="62"
     aria-valuemin="0"
     aria-valuemax="100"
     aria-label="Scan progress">
    62% Complete
</div>

<!-- 展開/收合按鈕 -->
<button aria-expanded="false" aria-controls="vulnerability-details">
    展開漏洞詳情
</button>

<!-- 表單欄位 -->
<label for="api-key">API 金鑰 *</label>
<input id="api-key"
       type="password"
       required
       aria-required="true"
       aria-describedby="api-key-help">
<span id="api-key-help" class="help-text">
    請輸入以 sk- 開頭的 OpenAI API 金鑰
</span>

<!-- 錯誤訊息 -->
<input aria-invalid="true" aria-describedby="error-msg">
<span id="error-msg" role="alert">
    API 金鑰格式不正確
</span>
```

**語義化 HTML**:
```html
<!-- 使用正確的標題層級 -->
<h1>OWASP 安全報告</h1>
  <h2>執行摘要</h2>
    <h3>漏洞統計</h3>
  <h2>OWASP 類別分佈</h2>

<!-- 使用 <nav> 包裝導航 -->
<nav aria-label="Main navigation">
    <ul>
        <li><a href="/dashboard">報告總覽</a></li>
        <li><a href="/report">單版本報告</a></li>
    </ul>
</nav>

<!-- 使用 <article> 包裝漏洞卡片 -->
<article aria-labelledby="vuln-1">
    <h3 id="vuln-1">SQL Injection in UserController.java</h3>
    <!-- 漏洞詳情 -->
</article>
```

#### 3. 顏色對比度

**文字對比度**:
```
標題 (黑色 #000000 on 白色 #FFFFFF):  21:1 ✅ AAA
內文 (深灰 #343A40 on 白色):         12.6:1 ✅ AAA
輔助文字 (中灰 #6C757D on 白色):     4.5:1 ✅ AA

Critical 標籤 (白色 on 紅色 #DC3545): 4.5:1 ✅ AA
High 標籤 (黑色 on 橙色 #FD7E14):     4.6:1 ✅ AA
Medium 標籤 (黑色 on 黃色 #FFC107):   5.2:1 ✅ AA
```

**不僅依賴顏色**:
```html
<!-- 嚴重性不僅用顏色，還用圖示和文字 -->
<span class="severity-critical">
    🚨 Critical
</span>

<span class="severity-high">
    ⚠️ High
</span>

<span class="severity-medium">
    ⚡ Medium
</span>
```

#### 4. 表單無障礙

```html
<form>
    <!-- 必填欄位明確標示 -->
    <label for="api-key">
        API 金鑰 <span aria-label="required">*</span>
    </label>
    <input id="api-key"
           type="password"
           required
           aria-required="true"
           aria-describedby="api-key-help api-key-error">

    <!-- 幫助文字 -->
    <span id="api-key-help" class="help-text">
        請輸入以 sk- 開頭的 OpenAI API 金鑰
    </span>

    <!-- 錯誤訊息 (初始隱藏) -->
    <span id="api-key-error" role="alert" aria-live="polite" hidden>
        API 金鑰格式不正確，請檢查後重新輸入
    </span>

    <!-- 群組相關選項 -->
    <fieldset>
        <legend>選擇 OWASP 版本</legend>
        <label>
            <input type="checkbox" name="versions" value="2017">
            OWASP Top 10 2017
        </label>
        <label>
            <input type="checkbox" name="versions" value="2021" checked>
            OWASP Top 10 2021 (預設)
        </label>
    </fieldset>
</form>
```

#### 5. 動態內容無障礙

```html
<!-- 即時更新區域 -->
<div role="status" aria-live="polite" aria-atomic="true">
    已分析 212 / 342 個檔案
</div>

<!-- 重要通知 -->
<div role="alert" aria-live="assertive">
    ❌ 掃描失敗: API 金鑰無效
</div>

<!-- 載入中狀態 -->
<button disabled aria-busy="true">
    <span class="spinner" aria-hidden="true"></span>
    載入中...
</button>
```

---

## 響應式設計策略

### 斷點定義

```css
/* 斷點系統 */
$breakpoint-sm: 576px;   /* 手機橫向 */
$breakpoint-md: 768px;   /* 平板直向 */
$breakpoint-lg: 1024px;  /* 平板橫向 */
$breakpoint-xl: 1280px;  /* 桌面 */
$breakpoint-xxl: 1920px; /* 大桌面 */
```

### 響應式佈局策略

#### 桌面 (≥1280px)

```
完整佈局：
┌───────────────────────────────────────┐
│ Header + Navigation                   │
├──────────┬────────────────────────────┤
│ Sidebar  │ Main Content               │
│ (250px)  │ (1030px)                   │
│          │                            │
│ - 快速   │ - 報告總覽                  │
│   過濾   │ - OWASP 類別列表            │
│ - 類別   │ - 漏洞詳情                  │
│   導航   │                            │
└──────────┴────────────────────────────┘

多版本對照：三欄並排
┌──────────┬──────────┬──────────┐
│ 2017     │ 2021     │ 2025     │
│ (400px)  │ (400px)  │ (400px)  │
└──────────┴──────────┴──────────┘
```

#### 平板 (768-1279px)

```
收合側邊欄：
┌───────────────────────────────────────┐
│ Header + Navigation                   │
├───────────────────────────────────────┤
│ [☰ Menu]  Main Content                │
│                                       │
│ - 報告總覽                             │
│ - OWASP 類別列表                       │
│ - 漏洞詳情                             │
│                                       │
└───────────────────────────────────────┘

多版本對照：兩欄並排 + 切換
┌──────────────┬──────────────┐
│ 2017         │ 2021         │
│ (384px)      │ (384px)      │
└──────────────┴──────────────┘
[切換到 2025 版本 ▼]
```

#### 手機 (< 768px)

```
單欄佈局：
┌───────────────────┐
│ Header            │
├───────────────────┤
│ [☰]  Page Title   │
├───────────────────┤
│                   │
│ Main Content      │
│ (100% width)      │
│                   │
│ - 執行摘要         │
│ - OWASP 類別       │
│   (摺疊卡片)      │
│                   │
└───────────────────┘

多版本對照：標籤頁切換
┌───────────────────┐
│ [ 2017 | 2021 | 2025 ] │
├───────────────────┤
│ 當前版本內容       │
│ (100% width)      │
└───────────────────┘
```

### 響應式組件

#### 1. 響應式表格

```html
<!-- 桌面: 完整表格 -->
<table class="responsive-table">
    <thead>
        <tr>
            <th>漏洞</th>
            <th>OWASP</th>
            <th>CWE</th>
            <th>嚴重性</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>SQL Injection</td>
            <td>A03:2021</td>
            <td>CWE-89</td>
            <td>Critical</td>
            <td><button>查看</button></td>
        </tr>
    </tbody>
</table>

<!-- 平板/手機: 卡片式佈局 -->
<div class="responsive-card">
    <h4>SQL Injection</h4>
    <div class="meta">
        <span>OWASP: A03:2021</span>
        <span>CWE: CWE-89</span>
        <span class="severity">Critical</span>
    </div>
    <button>查看詳情</button>
</div>
```

```css
@media (max-width: 768px) {
    .responsive-table {
        display: none;
    }
    .responsive-card {
        display: block;
    }
}

@media (min-width: 769px) {
    .responsive-table {
        display: table;
    }
    .responsive-card {
        display: none;
    }
}
```

#### 2. 響應式導航

```html
<!-- 桌面: 完整導航列 -->
<nav class="desktop-nav">
    <a href="/dashboard">報告總覽</a>
    <a href="/report">單版本報告</a>
    <a href="/comparison">多版本對照</a>
    <a href="/config">配置</a>
</nav>

<!-- 手機: 漢堡選單 -->
<nav class="mobile-nav">
    <button class="hamburger" aria-label="開啟選單">
        ☰
    </button>
    <div class="mobile-menu" hidden>
        <a href="/dashboard">報告總覽</a>
        <a href="/report">單版本報告</a>
        <a href="/comparison">多版本對照</a>
        <a href="/config">配置</a>
    </div>
</nav>
```

#### 3. 響應式字型

```css
/* Fluid Typography */
html {
    /* 根據視窗寬度調整基礎字型大小 */
    font-size: calc(14px + (16 - 14) * ((100vw - 320px) / (1920 - 320)));
}

@media (max-width: 320px) {
    html { font-size: 14px; }
}

@media (min-width: 1920px) {
    html { font-size: 16px; }
}

/* 標題響應式大小 */
h1 {
    font-size: clamp(24px, 5vw, 32px);
}

h2 {
    font-size: clamp(20px, 4vw, 24px);
}
```

---

## UI 組件庫

### 基礎組件

#### 1. 按鈕 (Button)

```html
<!-- 主要按鈕 -->
<button class="btn btn-primary">
    儲存配置
</button>

<!-- 次要按鈕 -->
<button class="btn btn-secondary">
    取消
</button>

<!-- 危險按鈕 -->
<button class="btn btn-danger">
    刪除
</button>

<!-- 圖示按鈕 -->
<button class="btn btn-icon" aria-label="重新整理">
    🔄
</button>

<!-- 載入中狀態 -->
<button class="btn btn-primary" disabled>
    <span class="spinner"></span>
    處理中...
</button>
```

```css
.btn {
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-primary {
    background: #4B9FD5;
    color: white;
}

.btn-primary:hover {
    background: #236A97;
    box-shadow: 0 4px 8px rgba(75, 159, 213, 0.3);
}

.btn-primary:active {
    transform: translateY(1px);
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
```

#### 2. 卡片 (Card)

```html
<div class="card">
    <div class="card-header">
        <h3>SQL Injection</h3>
        <span class="badge badge-critical">Critical</span>
    </div>
    <div class="card-body">
        <p>在 UserController.java:45 檢測到 SQL Injection 漏洞...</p>
    </div>
    <div class="card-footer">
        <button class="btn btn-primary">查看詳情</button>
    </div>
</div>
```

```css
.card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    transition: box-shadow 0.3s ease;
}

.card:hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.card-header {
    padding: 16px;
    border-bottom: 1px solid #E0E0E0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.card-body {
    padding: 16px;
}

.card-footer {
    padding: 12px 16px;
    background: #F3F3F3;
    border-top: 1px solid #E0E0E0;
}
```

#### 3. 標籤 (Badge)

```html
<span class="badge badge-critical">Critical</span>
<span class="badge badge-high">High</span>
<span class="badge badge-medium">Medium</span>
<span class="badge badge-low">Low</span>

<!-- 版本標籤 -->
<span class="badge badge-version-2017">OWASP 2017</span>
<span class="badge badge-version-2021">OWASP 2021</span>
<span class="badge badge-version-2025">OWASP 2025 (Preview)</span>
```

```css
.badge {
    display: inline-flex;
    align-items: center;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
}

.badge-critical {
    background: #DC3545;
    color: white;
}

.badge-high {
    background: #FD7E14;
    color: white;
}

.badge-version-2021 {
    background: #28A745;
    color: white;
}
```

#### 4. 進度條 (Progress Bar)

```html
<div class="progress" role="progressbar"
     aria-valuenow="62" aria-valuemin="0" aria-valuemax="100">
    <div class="progress-bar" style="width: 62%">
        62%
    </div>
</div>

<!-- 分段進度條 -->
<div class="progress-segmented">
    <div class="progress-segment" style="width: 6%" title="Critical: 3"></div>
    <div class="progress-segment progress-high" style="width: 26%" title="High: 12"></div>
    <div class="progress-segment progress-medium" style="width: 51%" title="Medium: 24"></div>
    <div class="progress-segment progress-low" style="width: 17%" title="Low: 8"></div>
</div>
```

```css
.progress {
    height: 24px;
    background: #E0E0E0;
    border-radius: 4px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #4B9FD5 0%, #236A97 100%);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 600;
    transition: width 0.5s ease;
}

.progress-segmented {
    display: flex;
    height: 8px;
    background: #E0E0E0;
    border-radius: 4px;
    overflow: hidden;
}

.progress-segment {
    background: #DC3545;
    transition: width 0.5s ease;
}

.progress-segment.progress-high {
    background: #FD7E14;
}
```

#### 5. 下拉選單 (Dropdown)

```html
<div class="dropdown">
    <button class="dropdown-toggle" aria-expanded="false">
        OWASP 2021 ▼
    </button>
    <ul class="dropdown-menu" hidden>
        <li><a href="#">OWASP 2017</a></li>
        <li><a href="#" class="active">OWASP 2021</a></li>
        <li><a href="#">OWASP 2025 (Preview)</a></li>
    </ul>
</div>
```

```css
.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-toggle {
    padding: 8px 16px;
    background: white;
    border: 1px solid #E0E0E0;
    border-radius: 4px;
    cursor: pointer;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 4px;
    background: white;
    border: 1px solid #E0E0E0;
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    min-width: 200px;
    z-index: 1000;
}

.dropdown-menu li {
    list-style: none;
}

.dropdown-menu a {
    display: block;
    padding: 8px 16px;
    color: #343A40;
    text-decoration: none;
}

.dropdown-menu a:hover {
    background: #F3F3F3;
}

.dropdown-menu a.active {
    background: #EAF4FB;
    color: #4B9FD5;
    font-weight: 600;
}
```

---

## 互動狀態與回饋

### 載入狀態

#### 1. 骨架屏 (Skeleton Screen)

```html
<!-- 載入中的漏洞卡片 -->
<div class="skeleton-card">
    <div class="skeleton-header">
        <div class="skeleton-text skeleton-text-lg"></div>
        <div class="skeleton-badge"></div>
    </div>
    <div class="skeleton-body">
        <div class="skeleton-text"></div>
        <div class="skeleton-text"></div>
        <div class="skeleton-text skeleton-text-sm"></div>
    </div>
</div>
```

```css
@keyframes skeleton-loading {
    0% { background-position: -200px 0; }
    100% { background-position: calc(200px + 100%) 0; }
}

.skeleton-text {
    height: 14px;
    background: linear-gradient(90deg,
        #F0F0F0 0px, #E0E0E0 40px, #F0F0F0 80px);
    background-size: 200px;
    animation: skeleton-loading 1.5s infinite;
    border-radius: 4px;
    margin-bottom: 8px;
}

.skeleton-text-lg {
    height: 20px;
    width: 60%;
}

.skeleton-text-sm {
    width: 40%;
}
```

#### 2. Spinner (旋轉載入圖示)

```html
<div class="spinner"></div>

<!-- 帶文字的 Spinner -->
<div class="loading">
    <div class="spinner"></div>
    <span>載入中...</span>
</div>
```

```css
@keyframes spin {
    to { transform: rotate(360deg); }
}

.spinner {
    width: 24px;
    height: 24px;
    border: 3px solid #E0E0E0;
    border-top-color: #4B9FD5;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

.loading {
    display: flex;
    align-items: center;
    gap: 12px;
}
```

### 成功/錯誤提示

#### Toast 通知

```html
<div class="toast toast-success" role="status" aria-live="polite">
    <span class="toast-icon">✅</span>
    <span class="toast-message">配置已儲存成功！</span>
    <button class="toast-close" aria-label="關閉">&times;</button>
</div>

<div class="toast toast-error" role="alert" aria-live="assertive">
    <span class="toast-icon">❌</span>
    <span class="toast-message">連線失敗: 無效的 API 金鑰</span>
    <button class="toast-close" aria-label="關閉">&times;</button>
</div>
```

```css
@keyframes toast-slide-in {
    from {
        transform: translateY(-100%);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.toast {
    position: fixed;
    top: 80px;
    right: 24px;
    min-width: 300px;
    max-width: 500px;
    padding: 16px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    display: flex;
    align-items: center;
    gap: 12px;
    animation: toast-slide-in 0.3s ease;
    z-index: 9999;
}

.toast-success {
    border-left: 4px solid #28A745;
}

.toast-error {
    border-left: 4px solid #DC3545;
}

.toast-icon {
    font-size: 24px;
}

.toast-close {
    margin-left: auto;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    opacity: 0.6;
}

.toast-close:hover {
    opacity: 1;
}
```

### Hover 效果

```css
/* 卡片 Hover */
.vulnerability-card {
    transition: all 0.3s ease;
}

.vulnerability-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

/* 按鈕 Hover */
.btn:hover {
    filter: brightness(1.1);
}

/* 連結 Hover */
a {
    color: #4B9FD5;
    text-decoration: none;
    transition: color 0.2s ease;
}

a:hover {
    color: #236A97;
    text-decoration: underline;
}
```

---

## 錯誤處理與空狀態

### 空狀態設計

#### 1. 無漏洞狀態

```html
<div class="empty-state">
    <img src="/assets/no-vulnerabilities.svg" alt="無漏洞" class="empty-state-image">
    <h3>🎉 太棒了！未檢測到漏洞</h3>
    <p>您的專案未發現任何 OWASP Top 10 2021 安全漏洞。</p>
    <p class="text-muted">建議定期執行掃描以持續監控安全狀況。</p>
    <button class="btn btn-primary">重新掃描</button>
</div>
```

```css
.empty-state {
    text-align: center;
    padding: 80px 40px;
    max-width: 500px;
    margin: 0 auto;
}

.empty-state-image {
    width: 200px;
    height: 200px;
    margin-bottom: 24px;
}

.empty-state h3 {
    font-size: 24px;
    margin-bottom: 12px;
}

.empty-state p {
    color: #6C757D;
    margin-bottom: 8px;
}
```

#### 2. 首次使用引導

```html
<div class="onboarding">
    <div class="onboarding-icon">🚀</div>
    <h2>歡迎使用 OWASP AI Security Plugin</h2>
    <p>請先完成插件配置，開始您的第一次掃描。</p>

    <ol class="onboarding-steps">
        <li>
            <span class="step-number">1</span>
            配置 AI API 金鑰
            <a href="/admin/settings" class="btn btn-sm btn-primary">前往配置</a>
        </li>
        <li>
            <span class="step-number">2</span>
            選擇 OWASP 版本
        </li>
        <li>
            <span class="step-number">3</span>
            執行首次掃描
        </li>
    </ol>
</div>
```

### 錯誤狀態

#### 1. 掃描失敗

```html
<div class="error-state">
    <div class="error-icon">❌</div>
    <h3>掃描失敗</h3>
    <p class="error-message">無法連線到 AI API，請檢查網路連線和 API 金鑰。</p>

    <details class="error-details">
        <summary>查看詳細錯誤資訊</summary>
        <pre><code>
Error: OpenAI API request failed
Status: 401 Unauthorized
Message: Invalid API key provided

Stack trace:
  at OpenAiProvider.analyzeCode (ai-connector.js:45)
  at ParallelAnalyzer.analyzeFile (orchestrator.js:102)
        </code></pre>
    </details>

    <div class="error-actions">
        <button class="btn btn-primary">重新嘗試</button>
        <button class="btn btn-secondary">檢查配置</button>
        <a href="/docs/troubleshooting">查看疑難排解指南</a>
    </div>
</div>
```

#### 2. 部分失敗

```html
<div class="partial-failure">
    <div class="alert alert-warning">
        ⚠️ 掃描部分完成
        <p>342 個檔案中有 30 個無法分析（超時或 API 錯誤），已跳過。</p>
        <button class="btn btn-sm">查看跳過的檔案</button>
    </div>

    <!-- 顯示成功分析的結果 -->
    <div class="results">
        <!-- 報告內容 -->
    </div>
</div>
```

---

## 總結

### UX 規格覆蓋範圍

本 UX Specification 完整涵蓋：

✅ **7 個核心畫面**的詳細線框圖和互動設計
✅ **多版本對照報告**的並排佈局和差異視覺化
✅ **漏洞詳情頁面**的資訊架構和 AI 建議展示
✅ **配置頁面**的分步引導和即時反饋
✅ **無障礙性實現**（WCAG 2.1 AA 合規）
✅ **響應式設計**（桌面、平板、手機）
✅ **UI 組件庫**（15+ 可重用組件）
✅ **互動狀態與回饋**（載入、成功、錯誤）

### 設計交付物

**前端開發團隊可直接使用**:
1. 線框圖（文字描述 + ASCII 圖）
2. 完整的 CSS 範例代碼
3. HTML 語義化結構範例
4. ARIA 標籤和無障礙實現
5. 響應式斷點和佈局策略
6. 互動行為和動畫規格

### 下一步建議

1. **設計稿製作**: 根據本規格使用 Figma/Sketch 製作高保真視覺稿
2. **前端實現**: 開始實現 UI 組件庫和核心畫面
3. **可用性測試**: 使用原型進行用戶測試，驗證 UX 設計
4. **無障礙審查**: 使用 axe DevTools 等工具驗證 WCAG 合規性

---

**文件結束**

**總頁數**: 約 40 頁
**總字數**: 約 20,000 字
**線框圖數量**: 10 個詳細線框圖
**程式碼範例**: 60+ 段 HTML/CSS 實現